(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();function p(c){return new Worker(""+new URL("idb.worker-DvAD-bDS.js",import.meta.url).href,{name:c?.name})}let m=class{worker;seq=0;pending=new Map;constructor(){this.worker=new p,this.worker.onmessage=t=>this.Message(t.data)}Message(t){const{id:e,ok:s,result:o,error:n}=t,i=this.pending.get(e);i&&(this.pending.delete(e),s?i.resolve(o):(i.reject(n),console.warn(t)))}Call(t,e){return new Promise((s,o)=>{const n=++this.seq;this.pending.set(n,{resolve:s,reject:o}),this.worker.postMessage({id:n,type:t,payload:e})})}},f=class{type="none";id=null;parentID=null;tabID=null;zIndex=null;x=0;y=0;w=0;h=0;_capture;constructor(){const t=document.createElement("canvas"),e=t.getContext("2d");this._capture={cav:t,ctx:e}}SetData(t={}){Object.assign(this,t),t.w&&(this._capture.cav.width=t.w),t.h&&(this._capture.cav.height=t.h)}},w=class extends f{bgColor;constructor(t){super(),this.type="square",this.bgColor=t.bgColor||"black",this.SetData(t),this.Render()}Save(){}Render(){const t=this._capture.cav,e=this._capture.ctx;e.fillStyle=this.bgColor,e.clearRect(0,0,t.width,t.height),e.fillRect(0,0,t.width,t.height)}Draw(t){const e=this._capture.cav;t.drawImage(e,this.x,this.y)}};const E={square:w};let v=class{parentNode;scope={min:.5,max:2,zoom:1,w:0,h:0,dpr:Math.round(window.devicePixelRatio)||1,bgStep:100,bgPattern:null};x=0;y=0;children={none:[],point:[],square:[],line:[],button:[]};isDragging=!1;isResizing=!1;layers={};constructor(t={}){this.parentNode=t.parentNode||document.body,this.InitLayers(),window.addEventListener("resize",()=>{this.Resize()}),this.Resize(),this.Loop()}get zoom(){return this.scope.zoom}set zoom(t){t>=this.scope.min&&t<=this.scope.max&&(this.scope.zoom=t)}Loop=()=>{(this.isDragging||this.isResizing)&&(this.Draw(),this.isDragging=!1,this.isResizing=!1),requestAnimationFrame(this.Loop)};InitLayers(){["background","board","effect"].forEach(t=>{const e=document.createElement("canvas"),s=e.getContext("2d");e.style="position:absolute; width:100%; height:100%;",this.parentNode.appendChild(e),this.layers[t]={cav:e,ctx:s}})}Resize(){this.scope.w=window.innerWidth,this.scope.h=window.innerHeight,Object.values(this.layers).forEach(t=>{t.cav.width=this.scope.w*this.scope.dpr,t.cav.height=this.scope.h*this.scope.dpr}),this.isResizing=!0}SpaceLine(t){return t/this.zoom}async LoadMap(t){console.log(t),this.children={none:[],point:[],square:[],line:[],button:[]},this.AddChild({type:"square",x:0,y:0,w:200,h:300,bgColor:"blue"}),this.AddChild({type:"square",x:-100,y:-400,w:300,h:300,bgColor:"orange"}),this.isResizing=!0}AddChild(t){if(typeof t.type!="string")return;let e;t.type==="square"&&(e=new E.square(t),this.children.square.push(e))}FindByID(t){const e=Object.values(this.children);for(const s of e){const o=s.find(n=>n.id===t);if(o)return o}return null}Draw(){const t=this.scope.w,e=this.scope.h,s=this.scope.dpr,o=this.scope.zoom;Object.values(this.layers).forEach(i=>{const A=i.ctx;A.setTransform(s,0,0,s,0,0),A.clearRect(0,0,t,e),A.translate(t/2,e/2),A.scale(o,o),A.translate(-this.x,-this.y)}),this.DrawBackground(),["none","point","square","line","button"].forEach(i=>{const A=this.children[i];if(!(A.length<=0))for(const a of A)a.Draw(this.layers.board.ctx)})}DrawBackground(){if(!this.layers.background)return;const t=this.layers.background.ctx,e=this.scope.bgStep,{w:s,h:o,dpr:n,zoom:i}=this.scope;if(!this.scope.bgPattern){const A=document.createElement("canvas");A.width=e,A.height=e;const a=A.getContext("2d");a.strokeStyle="rgb(54,63,63)",a.beginPath(),a.moveTo(0,0),a.lineTo(e,e),a.moveTo(e,0),a.lineTo(0,e),a.stroke(),this.scope.bgPattern=t.createPattern(A,"repeat")}if(this.scope.bgPattern){t.save(),t.setTransform(n,0,0,n,0,0),t.clearRect(0,0,s,o);const A=new DOMMatrix;A.translateSelf(s/2,o/2),A.scaleSelf(i,i),A.translateSelf(-this.x,-this.y),this.scope.bgPattern.setTransform(A),t.fillStyle=this.scope.bgPattern,t.fillRect(0,0,s,o),t.restore()}}};const I=.001,R=.002;let C=class{down=null;pinch=null;touchMode=null;constructor(t){const e=t.parentNode;e.addEventListener("contextmenu",s=>{s.preventDefault()}),e.addEventListener("wheel",s=>{r.zoom-=s.deltaY*I,r.isDragging=!0},{passive:!0}),e.addEventListener("mousedown",s=>{this.PanStart(s.offsetX,s.offsetY,s.timeStamp)}),e.addEventListener("mousemove",s=>{this.PanMove(s.offsetX,s.offsetY)}),e.addEventListener("mouseup",s=>{this.PanEnd(s.offsetX,s.offsetY,s.timeStamp)}),e.addEventListener("mouseleave",()=>{this.down=null,this.touchMode=null}),e.addEventListener("touchstart",s=>{if(s.touches.length===1&&this.touchMode!=="pinch"){const o=s.touches[0];this.touchMode="pan",this.PanStart(o.clientX,o.clientY,s.timeStamp)}if(s.touches.length===2){const o=s.touches[0],n=s.touches[1],i=o.clientX-n.clientX,A=o.clientY-n.clientY;this.touchMode="pinch",this.pinch={dist:Math.hypot(i,A)}}},{passive:!1}),e.addEventListener("touchmove",s=>{if(this.touchMode==="pan"&&s.touches.length===1){const o=s.touches[0];this.PanMove(o.clientX,o.clientY),s.preventDefault()}if(this.touchMode==="pinch"&&s.touches.length===2&&this.pinch){const o=s.touches[0],n=s.touches[1],i=o.clientX-n.clientX,A=o.clientY-n.clientY,a=Math.hypot(i,A),u=this.pinch.dist-a;this.pinch.dist=a,r.zoom+=u*R,r.isDragging=!0,s.preventDefault()}},{passive:!1}),e.addEventListener("touchend",s=>{if(this.touchMode==="pinch"&&s.touches.length<2){this.touchMode=null,this.pinch=null;return}if(this.touchMode==="pan"&&s.touches.length===0){const o=s.changedTouches[0],n=e.getBoundingClientRect(),i=o.clientX-n.left,A=o.clientY-n.top;this.touchMode=null,this.PanEnd(i,A,s.timeStamp)}})}PanStart(t,e,s){this.down={offsetX:t,offsetY:e,xView:r.x,yView:r.y,timeStamp:s},r.isDragging=!0}PanMove(t,e){if(!this.down)return;if(d.remote.id===null){const o=r.SpaceLine(t-this.down.offsetX),n=r.SpaceLine(e-this.down.offsetY);r.x=this.down.xView-o,r.y=this.down.yView-n,r.isDragging=!0}}async PanEnd(t,e,s){const o=this.down?.timeStamp??0,n=s-o<200,i=d.remote.id;n&&i!==null&&d.Action({x:t,y:e}),this.down=null,r.isDragging=!1}};const b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAVRJREFUeJzt3LFNw0AYgFGDmIEZaCIWoGUKeoaiZwpaFkBpmIEloEkKIgoMPr7EvCe5vST3RdZvRblpAgAAADhJ77uLGc4WWudw45dad/XO6zfw3wkQEyAmQEyA2Nxp5TdjpsnoC3M2ZYkZX4QDbkExt6CYJ+GYW1BMgJgAMQFiAqyIH2R+YMi4eL3ZrDLEy3Z7/OP1bvNXex31l2vtm7+/loxwsdRCh26vbkYtnXl6fV58zWEB9h7u3ka/xHD3j5fD1h46hq5h86dp7OfwHBATICZATICYADEBYgLEBIgJEBMgJkBMgJgAMQFiAsQEiAkQEyAmQEyAmAAxAWICxASICRATICZATICYADEBYgLEBIgJEBMgJkBMgJgAMQFiAsQEiAkQGxpg5F/8/9LIzzH8rIi1RBhlWIARJ4vwDWs/M2jpA5scWTbTSRxbBgAAAAAAn30A4fLQgWRlXGAAAAAASUVORK5CYII=",N="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAeBJREFUeJzt2U1SwkAQhuHWcok3wBWeAFZQcHuq3HkCXOENcD8urNGpVCIkM0x3pt/nAPz0l/4CExEAAAAAAAAAAAAAAAAAwHydzpdwOl+C9udwa73fhhBCIIg/TxpvulouRORnI0REXl+eHzQ+h0txC1JxIzxuhcoGdMWNEPG3FSYCSFFPFfTV0JDW68ncBnS1Xk/mA0i1WE+zCiDqBiHSRhhVjbkPjLlXaH+vsWa5AX3mWk/NBBBRTyOUrqE51lNzG9DHcj25CCCinnrUqiGr9eRqA/po19NjzTezbLVcyGq5kNP5Etb7rckb9t1o11Cq9vDZgMTmsJP34xsVpEFj+KZo1pBm57vfAO0r33UA2sMXcRyAheGbU+s+YOl3vrsNsHbluwrg4/PL1PBNuncNWXsu4GoDROT3vEf7c0TuAhCxF4I5NR9Van9XlxsQWdgE1wGI2AjBpLE1lFtbWiE0sQHxz9XmsJv8GmxCx61XdPdYYa6bYM4tgxw60yGEQv4b5LUDNUIoYGiIt55mEkKmvgGOPUomhEzpAKee4xNChji83IcoU0Ow9PBGxXq/LTaEKX/uSrwvElP/X6CgayEw/Apyf+KigG4IDF9BqV9ZyMDwAQAAAAAAAAAAAAD38A2ZOL2SNKZ2wgAAAABJRU5ErkJggg==",y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAedJREFUeJztnDFuwzAMRdWiXXuc3H/ucbJmSJcaBYIGjm2Jj5TfG7NY5ucnJSpJayIiIiIiIiIiIiIiIom5XS/32/Vyp9dxhHd6AWfnjV7AXh4z//Pru+S76ACYaQSo2gtKClA12P9RUoCZKNe41rK/WjPWATClsuXV2l/JBToApkymbN35VHGBDoApkSV79/0VXKADYNJnyNFTb3YX6AAYBYBJbc9eQ7fMZUgHwKTNjN4j56wu0AEweFbQlyu0Mw4/nA4gzVEBLUEwXex3Vhf0KF9d699ZhOjZN7o3oNlF6N20h+wAZhVhxI5p2BZsNhFGbVeH7oFnEWHkWSHkEFJViIhDWtgpsJoIUSfk0GN4FREixxPhc5DsIkTPhpBBVFYRiMEcNgnMJgI1FUVHsVlEIEfS3gfA9wGOo2EUAEYBYGzCje0DOgBGARrrREyALOWHRgfAKMAvlCMRASw/f+gAmLL3AY9796q/JfiIfFgPngVo+bxaeSvjgK2ZeUSIaa8k9wTlaDCIZ24hdRPuEQh63r9GSgeMCtoWN0z3tZRXXj7qpTOtJU0JiiwVmcoSnnF0MOi1YecAOvAL9Pkh3AFZAv+M6H/kHd4DKgW/tfg1hjXhCsFfqLRWERERERERERERERERWeEHFjPJPzQ9OhwAAAAASUVORK5CYII=",B="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAABEFJREFUeJztnb9q40AQxieXqwyBFAEHl1cmnTtjg17Kj5GXMlxId51dujx84MIQSBd0hZl4T2dZ++cb7aw1v+rgLGl2vp3V7uxoQ2QYhmEYhmEYvXOT2wBfpotZHfL7Xz/fimjb99wG+HJ3Ow+84k3EDjTFCEBE9PT84fW7zXokbAmOb7kN8CF0+Im9JgdFCHB3O/fu/UTHSAkfsvJQhADXjAmQGfUCpIzlJbwHxARANT50/GeQ7wFJIUUEYIOralnn7sGpz6+qZY2y5Rzw1SIbyj2X5+Tvn69E1L1CdRvKPTgmAojov2f7PJ9tcJ+9WY+87Q8FerOm811cZ5xrhHstE+v4Ju7C7JIjm45v3kNCBNiNLjnfpdmQpuNRTr/0fCJqtSHEdoQ9kJv4NoBxndCX41E2oEVIvkGo810261HvjkfYgBQh6eIU55cOSoTkCKiqZT005zOb9YhWq5ckHyavA94/X4tK/6JwIyCFZAFK2XmSANF2yEp4aFGAGHoYiABDigLU0MPAckFDiwIU8FTENU9JufcjI179fsC1I5INlYyCw3538f/vHx5FnivR+4kKGoJcx//+8+Psbybj7de/JYSQEEF9XRA73nV62xSQN0+OHMWQiggU0HQ0svc3HR8672YxOCpQQqCjQGUEuM6PXfDwdVW1rCfjLR32O5XRANsPQPX+w34X3evbcKMBIQIyClRFADsf5XjGjQYijAgo1KwDuqaXpT6ri2QBkMOPRO93Wa1ebtqmsCFwzRGiVCW6sW4FARsVi9TQ0wa/mFOGomalRez7wPsd0HQ4Uf8b6Zpw275Zz6mq5l/RECJIZ5GURJ2OS9+9n0FEQRsh0eEVAUPu6TGwv3zS81lnQRpmI7ltyD4NzTH8EOFmRKlkF2DomACZMQEyYwJkxgTITHYBJuNtYyerH3ghlpusAmhIC+e2wWslzCs6WxH7EVKg5r0AkkzGlZgNdWk6PCQZ550NPd7wdATMdDGrN2vZRJ1mUOloyCdKiA2ZvqIA1ftR+8KQ7wNQhbnSMyLUzAe5KZ99Gsr0ORvJPfNxUVUVcXTMKQq0lqUgUVkZhyjMYtxhR1tNEJGyCGDuHx7psN/9807QUpqIRn11dGxxroTjB1kdfXLgafbSNlOSLk+XwD7Q8GTwH2howL4Ru0JUTkM1g44CSAQMxfkS2BAUCPpUXogAQ+v9T88fsKQh5PsAhCElgmh7sgBD6/0MaiiyI8siQR1ZlhQB/ODYDRkNp6vE2q3i0D7Gjq2Mp9eDW7sOTSWyg1uT6Dq6uOvYYL6WsaOLI2g7vNt3Q8UO7wbgipCSN0lNcaTmbfj5Us4nEvxDbtPFrEYYnHIwLOp0Q1RbzqH+tMPYKJDaQEGjPhmX4kDtzicqQIBrxwTITBEChKY60KfbSlKEADFjeQnjP1EBdUEuGpJ3aIoRoJQhxTAMwzAMwzAK4C+ZeT3j3R9QKgAAAABJRU5ErkJggg==",x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAetJREFUeJzt3EFKw0AUh/EqHkREegIXCj2DIOLeO7h16bZ3ELciBc8guPEEUsSb6CrQloY2k9f5JpPvtyktJoT3n5dJJsTJRJIkSZIkSUrzRx/A0BwF7mu1+JH7rdoxfQBjZwAwA4D1OVd3mXCdE1qkFiblascQtrADYF6GwpyEYQYAM4DKuBakYQm5Wjk7vXDkr/j5/dq7rs4BsJPInV1dv0XubnA+3287b2MHwAwAZgAwA4AZAMwAYAYAMwCYAcBC74RzeH6667X9/eNr0JHEsANgBgAzAJgBwAwAZgAwA4AZAKyoG7Gbj5u174vZAjqSfIoIYLPwm7/XHAQaQFvh2/4uMojldD45/34I218qbA7Yt/h9t9lmOZ2vfZKchGFIAFEjOcXmqKe7YFQdMHu53Po7GUL2AMjRX6LRdEDb6G9QXTCKAHYVv0GEMIoASpY9gNx3tfuO/kbuLrADYEgAubqg6+hv5OyCajsgtfiNXCFgAaR0QY2roqEv6aW+orTr5qxr4SNHb5cV0+YVpS4v6RXxPKApcMQDmehTx6GXrYsIoFHjKWaXqibhQ02ch5yQqwpgiIo6BfVVwiPGruwAmAHADABmADADgBkAzABgBgAzAJgBwEKXIlL+ZdfY2QGSJEmSJEmSJNXvHxGGYJKsrivNAAAAAElFTkSuQmCC",Y=""+new URL("remove-Bp_BGg2G.png",import.meta.url).href,D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAvJJREFUeJztnL1qG0EUhU9CGgfyBEa4DUkpkEuZNIG0UpsHiMGdHyNdwH4At3YbSCPsMoItE9wGoScQRGVSrbNsdnZ3Zu7dO6M9XyUk7czofPOzM4IFCCGEEEIIIUMzn1+eWNb/3LJyQsjYeWbdAF/m88s/rs8eHj5n93uyanBb+CW5SeAibAwFGEMBxlCAMRRgDAUYQwHGUIAxFGAMBRhDAcZQgDFJHVz1OWyLJbXDOo4AYyjAmKSGI6A7DaU2/QCBAj6dn6vO1T9/vBQv883b3+Jl1rm+uvLO0/uCMvxvX9e+l3oxOTkTK2vz616sLBfvP8wA+EsIWgO0wwfkQhsifCA8kxexFS/3m9gi3Dze4Pvrj8GXnz7e4FSwOU3cHk2iro8SUIY/Oz6OakQbs90KX169877uYrcCFNsFAOvtFsv9JkpC9G2oZvglF7uV6vdDkfjt2ewD+oY6VPhSZCMA6A43t/CBzAQA7pBzDB/IUADwf9i5hg8I3IZakXPoVbIcAYcEBRhDAcZQgDGDLMKLonh6fTedNr7vovr9tnL70FZWW3ld18WQ/AhYFIV30NJ1aNafvABt+oar1RFGLUB7ZPUhmY1Y0zxbDWhRFK1zscQ83dUGDZIeAZqLXz1YV13196WFJC1gKDRFd0EBPagKkpaVzBowJK59SRtaoyRpAT7zbdd3LaeZNpIRkGuAsSQjIDXaOoRkZ8hiET7U3g9kMAKsF0ltkhGQa4CxiAkIubWz4m46fWqv64hDewdcksUacMhQAGxPRVUE1E8xU6Rpimlqq/YfQmJrQHVeBZqDH/J0s4k+9Q/dYUY9BYV0COlONGoBgF+gGiNYdB9QNrDvnx2p4Gp3/XMNVDZiQ+1epYOx6Cijn4KsoQBjKMAYCjCGAoyhAGMowBgKMIYCjKEAYyjAmGgB6+1Woh1ZIvHbow7jbo8mWO43o5Zg+rwgiQaMnaApqHw+GvlHaCZJPjUxV0KemkgIIYQQQgghhBBCxsNfQOTmge3/KbkAAAAASUVORK5CYII=";class Q{parentNode;display;remote={btn:null,id:null,type:null,data:null};constructor(t={}){this.parentNode=t.parentNode||document.body,this.display=new M({parentNode:this.parentNode}),this.AddButton("pointer","toggle","포인터",N),this.AddLine(),this.AddButton("square","toggle","도형1",b),this.AddButton("picture","toggle","그림도형",x),this.AddLine(),this.AddButton("favorate","action","즐겨찾기",y),this.AddButton("setting","action","환경설정",B),this.AddButton("remove","toggle","도형삭제",Y),this.AddButton("imagedownload","action","화면캡처",D)}AddLine(){const t=document.createElement("hr");t.classList.add("line"),this.parentNode.appendChild(t)}AddButton(t,e,s,o){const n=document.createElement("div");n.classList.add("button"),n.classList.add(e),o&&(n.style.backgroundImage=`url(${o})`),this.parentNode.appendChild(n),n.addEventListener("click",()=>{this.remote.id!==null?this.remote.type==="toggle"&&this.remote.id===t?this.End():(this.End(),this.Start(n,t,e,s),e==="action"&&this.Action()):(this.Start(n,t,e,s),e==="action"&&this.Action())})}Start(t,e,s,o){t.classList.add("menu_select"),this.display.text=o,this.remote.btn=t,this.remote.id=e,this.remote.type=s}Action(t={}){if(this.remote.id){switch(this.remote.id){case"square":console.log(`[설치] 좌표 (${t.x}, ${t.y}) 에 사각형 생성`);break;case"favorate":console.log("즐겨찾기 실행");break;case"imagedownload":console.log("화면 캡처 시작");break;default:console.log("실행:",this.remote.id)}this.End()}}End(){this.remote.btn&&(this.remote.btn.classList.remove("menu_select"),this.display.text=`
`,this.remote.btn=null,this.remote.id=null,this.remote.type=null)}}class M{parentNode;div;down=null;constructor(t={}){this.parentNode=t.parentNode||document.body;const e=document.createElement("div");this.div=e,e.classList.add("display"),e.innerText=`
`,this.parentNode.appendChild(e),e.addEventListener("pointerdown",o=>{e.setPointerCapture(o.pointerId),this.down={x:o.offsetX,y:o.offsetY}}),e.addEventListener("pointermove",o=>{if(!this.down)return;const n=o.clientX-this.down.x,i=o.clientY-this.down.y;this.parentNode.style.left=`${n}px`,this.parentNode.style.top=`${i}px`});const s=o=>{this.down=null,e.releasePointerCapture(o.pointerId)};e.addEventListener("pointerup",s),e.addEventListener("pointercancel",s)}set text(t){this.div.innerText=t}}const g=document.querySelector("#app"),S=new m,r=l(v,"view");l(C,"controller");const d=l(Q,"remocon"),h=document.createElement("div");h.id="remocon_reset_pos";g?.appendChild(h);h.onclick=()=>{d.parentNode.style.left="10px",d.parentNode.style.top="30px"};const k=async()=>{const c=await S.Call("loadSetting",{});console.log(c),await r.LoadMap("test1")};k();function l(c,t){const e=document.createElement("div");return e.id=t,g?.appendChild(e),new c({parentNode:e})}
